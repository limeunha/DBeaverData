--                                            테이블 생성, 추가, 삭제



-- ■ 1. EMP 테이블에서 부서별로 인원수, 평균, 급여, 급여의 합, 최소 급여, 최대 급여를 포함하는 EMP_DEPTNO 테이블을 생성하라. ■

CREATE TABLE EMP_DEPTNO( DEPNO, E_COUNT, E_AVG, E_SUM, E_MIN, E_MAX )
AS (
    SELECT DEPTNO, COUNT(DEPTNO), TRUNC(AVG(SAL), 3), SUM(SAL), MIN(SAL), MAX(SAL)
    FROM EMP
    GROUP BY DEPTNO
);

SELECT * FROM EMP_DEPTNO;
  SELECT DEPARTMENT_ID DEPTNO, 
  COUNT(DEPARTMENT_ID), --부서별 직원수
  TRUNC(AVG(SALARY), 3),--부서별 평균 연봉
  SUM(SALARY), --부서별 연봉 합산
  MIN(SALARY), --부서에서 가장 작은 연봉
  MAX(SALARY) --부서에서 가장 높은 연봉
    FROM EMPLOYEES
    GROUP BY DEPARTMENT_ID;
    
   SELECT DEPTNO, COUNT(DEPTNO), TRUNC(AVG(SAL), 3), SUM(SAL), MIN(SAL), MAX(SAL)
    FROM EMP
    GROUP BY DEPTNO;
    
   SELECT * FROM EMP;
   
  
  -- ■ 2. EMP_DEPTNO 테이블에 ETC COLUMN을 추가하라. 단 자료형은 VARCHAR2(50) 사용하라. ■
 	 SELECT * FROM EMP_DEPTNO;
  
  	ALTER TABLE EMP_DEPTNO ADD ETC VARCHAR2(50);
 
 
  -- ■ 3. EMP_DEPTNO 테이블에 ETC COLUMN을 수정하라. 자료형은 VARCHAR2(15)로 하라. ■
 	 ALTER TABLE EMP_DEPTNO MODIFY ETC VARCHAR2(15);


-- ■ 4. EMP_DEPTNO 테이블에 있는 ETC을 삭제하고 확인하라. ■
  	ALTER TABLE EMP_DEPTNO DROP COLUMN ETC;


-- ■ 5. 이전에 생성한 EMP_DEPTNO 테이블의 이름을 EMP_DEPT로 변경하라. ■

  RENAME EMP_DEPTNO TO EMP_DEPT;
 
  DESCRIBE EMP_DEPT;
-- ■ 6. EMP_DEPT 테이블을 삭제하라. ■
    DROP TABLE  EMP_DEPT;
  
   
   --                                          select 구문
   
   

-- ■ 1. emp 테이블에서 사원번호, 사원이름, 월급을 출력하시오. 
 	SELECT * FROM EMP;
   
	SELECT EMPNO,ENAME,SAL
	FROM EMP;

-- ■ 2. emp 테이블에서 사원이름과 월급을 출력하는데 컬럼명은 이 름, 월 급으로 바꿔서 출력하시오. 

	SELECT RENAME "이름", SAL "월급"
	FROM EMP;


-- ■ 3. emp 테이블에서 사원번호, 사원이름, 월급, 연봉을 구하고 각각 컬럼명은 사원번호, 사원이름, 월급, 연봉으로 출력하시오, 
	
	SELECT EMPNO "사원번호",ENAME "사원이름",SAL "월급", SAL*12 "연봉"
	FROM EMP;


-- ■ 4. emp 테이블  의 업무(job)를 중복되지 않게 표시하시오. 

	SELECT DISTINCT job
	FROM EMP;


-- ■ 5. emp 테이블의 사원명과 업무로 연결(SMITH, CHECK)해서 표시하고 컬럼명은 Employee and job으로 표시하시오. 
	SELECT * FROM EMP;

	SELECT ENAME || 'AND' || JOB AS  Employee and job
	FROM EMP
	WHERE ENAME ='SMITH' AND JOB= 'CHECK';
	


-- ■ 1. EMPLOYEES table의 모든 자료를 출력하라  

SELECT * FROM EMPLOYEES;


-- ■ 2. EMPLOYEES table의 컬럼들을 모두 출력하라.

DESCRIBE EMPLOYEES;




	--                                                    INSERT INTO 



-- ■ 3. EMPLOYEES에서 사원번호, 이름, 급여, 담당업무를 출력하라. 
SELECT * FROM EMPLOYEES;

SELECT EMPLOYEE_ID, LAST_NAME, SALARY,JOB_ID
FROM EMPLOYEES;

-- ■ 4. 모든 종업원의 급여를 $300증가 시키기 위해서 덧셈 연산자를 사용하고 결과에 SALARY+300 디스플레이 합니다. 

SELECT SALARY +300 AS "SALARY+300"
FROM EMPLOYEES;

-- ■ 5. EMP 테이블에서 사원번호, 이름, 급여, 보너스, 보너스 금액을 출력여라 (참고로 보너스는 월급 + (월급 * 커미션)) 
SELECT * FROM EMP;

SELECT EMPNO, ENAME, SAL, SAL+(SAL*COMM) AS "BONUS"
FROM EMP;


-- ■ 6. EMPLOYEES 테이블에서 LSAT_NAME을 이름으로 SALARY을 급여로 출력하여라. 
SELECT * FROM EMPLOYEES; 

SELECT LAST_NAME AS '이름' AND SALARY AS '급여'
FROM EMPLOYEES;


-- ■ 7. EMPLOYEES 테이블에서 LAST_NAME을 Name으로 SALARY*12를 Annual Salary(연봉)로 출력하여라.
SELECT LAST_NAME AS 'Name' , SALARY*12 AS "Annual Salary"
FROM EMPLOYEES;


-- ■ 8. EMPLOYEES 테이블에서 이름과 업무를 연결하여 출력하여라. 
SELECT LAST_NAME || '-' || JOB_ID AS "Name and Job"
FROM EMPLOYEES;

-- ■ 9. EMPLOYEES 테이블에서 이름과 업무를 "KING is a PRESIDENT" 형식으로 출력하여라. 
SELECT LAST_NAME || 'is a' || JOB_ID AS "KING IS A PRESIDENT"
FROM EMPLOYEES;


-- ■ 10. EMPLOYEES 테이블에서 이름과 연봉을 "KING: 1 Year salary = 60000" 형식으로 출력하여라. 
SELECT LAST_NAME || ': 1 Year salary ' || SALARY*12 AS "KING : 1 Year salary = 60000"
FROM EMPLOYEES;


-- ■ -- 11. EMPLOYESS 테이블에서 JOB을 모두 출력하라.

SELECT JOB
FROM EMPLOYEES;



--                                                        select 구문



-- ■ 1. EMPLOYEES 테이블에서 급여가 3000이상인 사원읜 정보를 사원번호, 이름, 담당업무, 급여를 출력하라. ■
SELECT EMPLOYEE_ID,LAST_NAME, JOB_ID, SALARY
FROM EMPLOYEES
WHERE SALARY >= 3000;


-- ■ 2. EMPLOYEES 테이블에서 담당 업무가 ST_MAN 인 사원의 정보를 사원번호, 성명, 담당업무, 급여, 부서번호를 출력하라. ■
SELECT * FROM EMPLOYEES;

SELECT EMPLOYEE_ID, LAST_NAME,JOB_ID,SALARY
FROM EMPLOYEES
WHERE JOB_ID = 'ST_MAN';


-- ■ 3. EMPLOYEES 테이블에서 입사일자가 2006년 1월 1일 이후에 입사한 사원의 정보를 사원번호, 성명, 담당업무, 급여, 입사일자, 부서번호를 출력하라. ■

SELECT  EMPLOYEE_ID,LAST_NAME,JOB_ID,SALARY,HIRE_DATE
FROM EMPLOYEES
WHERE HIRE_DATE =>'2006.01.01';


-- ■ 4. EMPLOYEES 테이블에서 급여가 3000에서 5000사이의 정보를 성명, 담당업무, 급여, 부서번호를 출력하라. ■
SELECT * FROM EMPLOYEES;

SELECT LAST_NAME, JOB_ID,SALARY,DEPARTMENT_ID 
FROM EMPLOYEES
WHERE SALARY BETWEEN 3000 AND 5000; 

-- ■ 5. EMPLOYEES 테이블에서 사원번호가 145, 152, 203 인 사원의 정보를 사원번호, 성명, 담당업무, 급여, 입사일자를 출력하라. ■

SELECT EMPLOYEE_ID,LAST_NAME,JOB_ID,DEPARTMENT_ID,SALARY,HIRE_DATE
FROM EMPLOYEES
WHERE EMPLOYEE_ID IN (145,152,203);

-- ■ 6. EMPLOYEES 테이블에서 입사일자가 05년도에 입사한 사원의 정보를 사원번호, 성명, 담당업무, 급여, 입사일자, 부서번호를 출력하라. ■
SELECT * FROM EMPLOYEES;
SELECT EMPLOYEE_ID,LAST_NAME,JOB_ID,SALARY,HIRE_DATE,DEPARTMENT_ID
FROM EMPLOYEES
WHERE EXRACT( YEAR FROM HIRE_DATE) = '2005';

-- ■ 7. EMPLOYEES 테이블에서 보너스가 NULL인 사원의 정보를 사원번호, 성명, 담당업무, 급여, 입사일자, 보너스, 부서번호를 출력하라. ■


SELECT EMPLOYEE_ID,LAST_NAME,JOB_ID,SALARY,HIRE_DATE,DEPARTMENT_ID,BONUS
FROM EMPLOYEES
WHERE BONUS IS NULL;


-- ■ 8. EMPLOYEES 테이블에서 급여가 1100이상이고 JOB이 ST_MAN 인 사원의 정보를 사원번호, 성명, 담당업무, 급여, 입사일자, 부서번호를 출력하라. ■
SELECT EMPLOYEE_ID,LAST_NAME,JOB_ID,SALARY,HIRE_DATE,DEPARTMENT_ID
FROM EMPLOYEES
WHERE SALARY >=1100 AND JOB_ID = 'ST_MAN';


-- ■ 9. EMPLOYEES 테이블에서 급여가 10000이상이거나 JOB이 Manager 인 사원의 정보를 사원번호, 성명, 담당업무, 급여, 입사일자, 부서번호를 출력하라. ■
SELECT EMPLOYEE_ID,LAST_NAME,JOB_ID,SALARY,HIRE_DATE,DEPARTMENT_ID
FROM EMPLOYEES
WHERE SALARY >=10000 OR JOB_ID = 'Manager';


-- ■ 10. EMPLOYEES 테이블에서 JOB이 ST_MAN, SA_MAN, SA_REP가 아닌 사원의 정보를 사원번호, 성명, 담당업무, 급여, 부서번호를 출력하라. ■


-- ■ 11. 업무가 PRESIDENT(AD_PRES) 이고 급여가 12000이상이거나 업무가 SA_MAN인 사원의 정보를 사원번호, 이름, 업무, 급여를 출력하라. ■


-- ■ 12. 업무가 PRESIDENT(AD_PRES) 또는 SA_MAN 이고 급여가 12000이상이거나 사원의 정보를 사원번호, 이름, 업무, 급여를 출력하라. ■



  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  